<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>THE DAYLUGE</title>

<!-- Vintage typewriter font -->
<link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet">

<style>
  :root{
    /* Link color palette (darker blue/green) */
    --red:#cc0000; 
    --orange:#ff6600; 
    --green:#005f00;      /* darker green */
    --lime:#228b22; 
    --blue:#003366;       /* darker blue */
    --light-blue:#000066; 
    --indigo:#4b0082; 
    --violet:#6600cc; 
    --pink:#ff3399;

    /* Neutral newspaper tones */
    --ink:#111; 
    --rule:#bfbfbf;
    --maxw:1400px;

    --panel-bg:#ffffffee;
    --panel-border:#cfcfcf;
  }

  /* Color classes for links */
  .c-red{color:var(--red)}
  .c-orange{color:var(--orange)}
  .c-green{color:var(--green)}
  .c-lime-green{color:var(--lime)}
  .c-blue{color:var(--blue)}
  .c-light-blue{color:var(--light-blue)}
  .c-indigo{color:var(--indigo)}
  .c-violet{color:var(--violet)}
  .c-pink{color:var(--pink)}
  .c-purple{color:var(--violet)}
  .c-black{color:#000}

  *{box-sizing:border-box;margin:0;padding:0}
  html, body {height:100%}

  /* Simple white background */
  body{
    font-family:'Special Elite', monospace;
    color:var(--ink);
    line-height:1.5;
    background:#fff;
    padding:20px;
    position:relative;
  }

  .wrap{max-width:var(--maxw); margin:0 auto; position:relative; z-index:1;}

  header{text-align:center; margin-bottom:10px;}
  h1{text-transform:uppercase; letter-spacing:.5px; font-size:36px; cursor:pointer;}

  nav{
    text-align:center; margin:8px 0 18px; padding-bottom:10px;
    border-bottom:1px dashed var(--rule);
  }
  nav a{color:#333; text-decoration:none; font-weight:bold; margin:0 12px;}
  nav a:hover{text-decoration:underline;}

  /* 3-column layout on desktop; 2 on tablet; 1 on mobile */
  .grid{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px 18px;
    margin-top:10px;
  }
  @media(max-width:900px){.grid{grid-template-columns:repeat(2,1fr);}}
  @media(max-width:600px){.grid{grid-template-columns:1fr;} h1{font-size:28px;}}

  .link a{
    display:block;
    font-size:20px;
    font-weight:bold;
    text-decoration:none;
    word-break:break-word;
    padding:2px 0;
    text-shadow:0 .2px 0 rgba(0,0,0,0.35);
  }
  .link a:hover{text-decoration:underline;}

  /* Bottom archive link */
  .archive-bottom{
    position:fixed;
    bottom:10px;
    left:10px;
    font-size:11px;
    color:#666;
    text-decoration:underline;
    cursor:pointer;
    opacity:0.5;
  }
  .archive-bottom:hover{
    opacity:0.8;
    color:#333;
  }

  /* Archive modal */
  .archive-modal{
    display:none; position:fixed; inset:0; z-index:50; background:rgba(0,0,0,0.4);
    align-items:center; justify-content:center; padding:16px;
  }
  .archive-modal.show{display:flex;}
  .archive-card{
    background:#fff; border-radius:10px; padding:16px; max-width:800px; width:100%;
    max-height:80vh; overflow:auto; border:1px solid #ddd; box-shadow:0 10px 26px rgba(0,0,0,0.25);
  }
  .archive-card h3{margin-bottom:10px;}
  .archive-list .link a{font-size:16px;}
  .archive-close{float:right; cursor:pointer; font-weight:bold;}

  .loading{text-align:center; color:#666; margin:40px 0;}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>THE DAYLUGE</h1>
  </header>
  <nav>
    <a href="/">Home</a>
  </nav>

  <!-- Archive Modal -->
  <div id="archiveModal" class="archive-modal" aria-hidden="true">
    <div class="archive-card">
      <span id="closeArchive" class="archive-close">âœ•</span>
      <h3>Archive</h3>
      <div id="archiveList" class="archive-list">
        <p style="color:#555;">Archive feature coming soon.</p>
      </div>
    </div>
  </div>

  <!-- Grid of links -->
  <div id="grid" class="grid">
    <div class="loading">Loading links...</div>
  </div>
</div>

<!-- Archive link (bottom left) -->
<div class="archive-bottom" onclick="openArchiveModal()">archive</div>

<script>
const MAX_ACTIVE = 48;
let allLinks = [];

function escapeHTML(s){ 
  return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); 
}

// Load links from simple text file
async function loadLinks() {
  try {
    const response = await fetch('/links.txt');
    if (response.ok) {
      const text = await response.text();
      const lines = text.split('\n').filter(line => line.trim());
      
      allLinks = lines.map(line => {
        const parts = line.split('|');
        if (parts.length === 3) {
          return {
            title: parts[0].trim(),
            url: parts[1].trim(),
            color: parts[2].trim(),
            status: 'active'
          };
        }
        return null;
      }).filter(link => link !== null);
      
      console.log(`Loaded ${allLinks.length} links from text file`);
    } else {
      throw new Error('Could not load links.txt');
    }
  } catch (error) {
    console.log('Error loading links, using fallback');
    // Fallback if file doesn't exist yet
    allLinks = [
      {title:"Pablo Escobar Lost $72 Million a Month to Rats and Moisture Damage", url:"https://x.com/bizhustlez/status/1960013189258887243?s=42", color:"c-indigo", status:"active"}
    ];
  }
  renderGrid();
}

function renderGrid() {
  const gridEl = document.getElementById('grid');
  const activeLinks = allLinks.filter(link => link.status === 'active').slice(0, MAX_ACTIVE);
  
  gridEl.innerHTML = activeLinks.map(link => `
    <div class="link">
      <a class="${link.color || 'c-black'}" href="${link.url}" target="_blank" rel="noopener">
        ${escapeHTML(link.title)}
      </a>
    </div>
  `).join('');
}

// Archive modal function
function openArchiveModal() {
  document.getElementById('archiveModal').classList.add('show');
  document.getElementById('archiveModal').setAttribute('aria-hidden', 'false');
}

document.getElementById('closeArchive').addEventListener('click', () => {
  document.getElementById('archiveModal').classList.remove('show');
  document.getElementById('archiveModal').setAttribute('aria-hidden', 'true');
});

document.getElementById('archiveModal').addEventListener('click', (e) => {
  if (e.target === document.getElementById('archiveModal')) {
    document.getElementById('archiveModal').classList.remove('show');
    document.getElementById('archiveModal').setAttribute('aria-hidden', 'true');
  }
});

// Load the links when page loads
loadLinks();
</script>
</body>
</html>
